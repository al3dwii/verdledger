# ---- build stage -----------------------------------------------------------
FROM node:20-alpine AS build
WORKDIR /app
COPY . .
RUN pnpm install --prod
RUN pnpm -F @verdledger/api-server build

# ---- runtime stage ---------------------------------------------------------
FROM node:20-alpine
WORKDIR /app
COPY --from=build /app .
CMD ["node", "apps/api-server/dist/index.js"]
